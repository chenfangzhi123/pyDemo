'''
批量解除机器人封禁
'''

import json
import requests

all_user = [1002341, 1002369, 1002397, 1002489, 1002555, 1002563, 1002593, 1002719, 1002753, 1002761, 1002769,
            1002771, 1002777, 1002779, 1002781, 1002783, 1002803, 1002829, 1002833, 1002835, 1002879, 1002911, 1002919,
            1002923, 1002939, 1002959, 1002971, 1002979, 1002987, 1002989, 1002991, 1002993, 1002997, 1003005, 1003009,
            1003011, 1003015, 1003029, 1003035, 1003077, 1003329, 1004443, 1004451, 1004455, 1004461, 1004591, 1004595,
            1004603, 1004621, 1004679, 1004699, 1004872, 1004889, 1004894, 1004907, 1004910, 1004924, 1004934, 1004936,
            1004939, 1004957, 1004960, 1004968, 1004970, 1004972, 1004984, 1005019, 1005044, 1005050, 1005052, 1005054,
            1005056, 1005063, 1005064, 1005093, 1005396, 1005480, 1005481, 1005559, 1006174, 1006181, 1006182, 1006201,
            1006213, 1006221, 1006244, 1006253, 1006259, 1006272, 1006280, 1006283, 1006286, 1006289, 1006342, 1006352,
            1006353, 1006370, 1006388, 1006396, 1006399, 1006400, 1006405, 1006423, 1006428, 1006435, 1006437, 1006445,
            1006447, 1006465, 1006475, 1020844]
import my_logging
from retry import retry


@retry(tries=3, delay=1)
def do_action():
    _param = {'val': user_id}
    res = requests.get('http://manager-api.mapple.fun/user/query?type=0&no=1&size=1', params=_param,
                       headers=_header)
    black_info = json.loads(res.text)['dataInfo']['list'][0]['black']
    if black_info:
        post_res = requests.post('http://manager-api.mapple.fun/user/black', headers=_header,
                                 params={'type': 1, 'userid': user_id, 'b_id': black_info[0]['blackId']})
        print("结果：", json.loads(post_res.text)['code'])
    else:
        print(user_id, "已经解禁")


if __name__ == '__main__':
    _header = {"X-Token": '16_2b32f9495a1e4c98b979add8fa86f9ea'}
    for user_id in all_user:
        do_action()
